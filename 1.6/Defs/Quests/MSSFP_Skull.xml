<?xml version="1.0" encoding="utf-8"?>

<Defs>
    <QuestScriptDef>
        <defName>MSSFP_OpportunitySite_Skull</defName>
        <rootSelectionWeight>3.0</rootSelectionWeight>
        <rootMinPoints>0</rootMinPoints>
        <autoAccept>true</autoAccept>
        <questNameRules>
            <rulesStrings>
                <li>questName->Fallen Sky-Knight</li>
            </rulesStrings>
        </questNameRules>
        <questDescriptionRules>
            <rulesStrings>
                <li>questDescription(askerIsNull==true)->We've intercepted messages about an enormous structure believed to be the skull of a fallen sky-knight. It's not far from [map_definite]. \n\nIt seems that [allSitePartsDescriptionsExceptFirst]</li>
            </rulesStrings>
        </questDescriptionRules>
        <root Class="QuestNode_Sequence">
            <nodes>
                <li Class="QuestNode_SubScript">
                    <def>Util_RandomizePointsChallengeRating</def>
                    <parms>
                        <pointsFactorTwoStar>4</pointsFactorTwoStar>
                        <pointsFactorThreeStar>8</pointsFactorThreeStar>
                    </parms>
                </li>

                <li Class="QuestNode_SubScript">
                    <def>Util_GetDefaultRewardValueFromPoints</def>
                </li>

                <li Class="QuestNode_SubScript">
                    <def>Util_AdjustPointsForDistantFight</def>
                </li>

                <li Class="QuestNode_GetMap">
                    <canBeSpace>true</canBeSpace>
                </li>

                <li Class="QuestNode_Set">
                    <name>askerIsNull</name>
                    <value>true</value>
                </li>

                <li Class="QuestNode_GetSiteTile">
                    <storeAs>siteTile</storeAs>
                    <preferCloserTiles>true</preferCloserTiles>
                    <selectLandmarkChance>0.5</selectLandmarkChance>
                    <allowedLandmarks>
                        <li MayRequire="Ludeon.RimWorld.Odyssey">Wetland</li>
                        <li MayRequire="Ludeon.RimWorld.Odyssey">Archipelago</li>
                        <li MayRequire="Ludeon.RimWorld.Odyssey">CoastalIsland</li>
                        <li MayRequire="Ludeon.RimWorld.Odyssey">Peninsula</li>
                        <li MayRequire="Ludeon.RimWorld.Odyssey">Bay</li>
                        <li MayRequire="Ludeon.RimWorld.Odyssey">TerraformingScar</li>
                        <li MayRequire="Ludeon.RimWorld.Odyssey">LavaLake</li>
                        <li MayRequire="Ludeon.RimWorld.Odyssey">Dunes</li>
                    </allowedLandmarks>
                </li>

                <li Class="QuestNode_Set">
                    <name>siteThreatChance</name>
                    <value>0</value>
                </li>

                <li Class="QuestNode_GetSitePartDefsByTagsAndFaction">
                    <storeAs>sitePartDefs</storeAs>
                    <storeFactionAs>siteFaction</storeFactionAs>
                    <sitePartsTags>
                        <li>
                            <tag>MSSFP_FallenSkyKnight</tag>
                        </li>
                    </sitePartsTags>
                </li>

                <li Class="QuestNode_GetDefaultSitePartsParams">
                    <tile>$siteTile</tile>
                    <faction>$siteFaction</faction>
                    <sitePartDefs>$sitePartDefs</sitePartDefs>
                    <storeSitePartsParamsAs>sitePartsParams</storeSitePartsParamsAs>
                </li>

                <li Class="QuestNode_SubScript">
                    <def>Util_GenerateSite</def>
                    <parms>
                        <hiddenSitePartsPossible>true</hiddenSitePartsPossible>
                    </parms>
                </li>

                <li Class="QuestNode_SpawnWorldObjects">
                    <worldObjects>$site</worldObjects>
                </li>

                <li Class="QuestNode_AddItemsReward">
                    <items>$generatedItemStashThings</items>
                    <inSignalChoiceUsed>site.MapGenerated</inSignalChoiceUsed>
                    <generateQuestParts>false</generateQuestParts>
                </li>

                <li Class="QuestNode_NoWorldObject">
                    <worldObject>$site</worldObject>
                    <node Class="QuestNode_End">
                    </node>
                </li>
            </nodes>
        </root>
    </QuestScriptDef>
</Defs>
